# 宝塔面板后端启动配置说明

## 错误原因

1. **ImportError: attempted relative import with no known parent package**
   - 原因：直接运行 `python /www/wwwroot/backend/app/main.py`，Python 无法识别 `app` 包
   - 解决：必须从 `backend` 目录启动，并作为模块运行

2. **ModuleNotFoundError: No module named 'app.services.stock_alert_service'**
   - 原因：工作目录或 PYTHONPATH 错误，导致找不到 app 包
   - 解决：确保从 `backend` 目录启动，并同步最新代码

## 正确启动方式

### 方式一：使用 uvicorn（推荐）

在宝塔「Python 项目管理」或「Supervisor」中配置：

- **启动目录**：`/www/wwwroot/backend`
- **启动命令**：`uvicorn app.main:app --host 0.0.0.0 --port 8000`

### 方式二：使用 run.py

- **启动目录**：`/www/wwwroot/backend`
- **启动命令**：`python run.py`

### 方式三：命令行手动启动

```bash
cd /www/wwwroot/backend
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

## 宝塔 Python 项目管理配置

1. 网站 → Python 项目 → 添加项目
2. **项目路径**：`/www/wwwroot/backend`
3. **启动文件**：留空或填 `run.py`
4. **启动方式**：选「uwsgi」或使用「模块」模式
5. 若使用 Supervisor，启动命令填：
   ```
   cd /www/wwwroot/backend && uvicorn app.main:app --host 0.0.0.0 --port 8000
   ```

## 重要：工作目录必须是 backend

- ✅ 正确：`/www/wwwroot/backend`（backend 目录）
- ❌ 错误：`/www/wwwroot/backend/app`（app 子目录）

## 确保代码同步

若出现 `ModuleNotFoundError: No module named 'app.services.stock_alert_service'`，说明服务器上的代码可能不完整。请：

1. 从 Git 拉取最新代码
2. 或手动上传 `backend/app/services/stock_alert_service.py`
